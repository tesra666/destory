(window.webpackJsonp=window.webpackJsonp||[]).push([["sub"],{"0081":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAACHElEQVRIS8WWv2sUQRSAv5efBBSusBERAnqVlVYGRcUTRGtz5najYmcQ/wJFhPwJNlqIgtwuiYWVCBrREDUgCBZWKsQijYhwAcGQ+/FkI+LtuXMz7o5k233zffPevnmzwhY9skVenMR6h+2McRM4A6whzEqNW0U2bRXrQ0qs8xjlYJdIUSoS8jyvvK9YI3YAT4D9fwl+ZX3du1jvs5NBngL7MuEdpmSaOa9ijdlNh2cIZQM4pkYognoT6z32MMICMG6APqLDJZS2VTpKS6p8zYpLfWOtU0Y2G2aXFeoe8I42k3KOT91LesUvEQ65M50jX0uQ5vaKNxCGnXHugRsSMGrOOOIFcNSd5xy5KAHHzOKYcZQ6MAFuU82iTrp+GSGUGp+N4t8vdJ5tND2UvEFTLvPd2tXOhfMQaJ3VHhyZiEyx3qXEEGOFpS1+yEUa1lJr0lwQ99xERf1vaDEl51npN0AWEY4UNWWsX5IgzU0PkIh1SB90T5toSsBIvwGyBBz2JPuDUV5JmOamM55nL23mUA54lK+iHJeQj/YBkvx5tB0GiDDIALeB05kbVVYYpiLVdGMlsbnPsd5ggDIRwllDdT7QoSLTrFqP07+UVyNqQGRY8x44IQFfTMz8GdeZRbiWAX5Lk5NygW/9Eskvjqmgmz+D3YxlhjglVdZs1cstTsBaZwbhKkoJeECDK6bbqHcjhcS2rP5LqYtIk7U/ASJyih+ogNV9AAAAAElFTkSuQmCC"},"00d6":function(t,e,s){},"04a0":function(t,e,s){},"0522":function(t,e,s){},"11b2":function(t,e,s){"use strict";s("52eb")},"1f33":function(t,e,s){},2724:function(t,e,s){t.exports=s.p+"img/box-empty.eb00c39e.png"},"27da":function(t,e,s){"use strict";s.r(e);s("99af"),s("fb6a");var a=s("2909"),r=s("8785"),i=(s("96cf"),s("1da1")),n=s("42bf"),o=s("54f8"),c=s("f588"),l=s("5184"),d=s("a953"),u=s("35ad"),h=s("d044"),f=s.n(h);function p(){var t=Object(r.a)(["query ($to: Bytes!, $token: Bytes!, $first: Int!, $skip: Int!) {\n            logs(where: { to: $to, token: $token }, first: $first, skip: $skip, orderBy: timestamp, orderDirection: desc) {\n                id,\n                from,\n                to,\n                mid,\n                token,\n                amount,\n                timestamp\n              }\n            }"]);return p=function(){return t},t}function m(){var t=Object(r.a)(["query ($id: ID!) {\n            seller(id: $id) {\n                id\n                address\n                token\n                amount\n                sellerUser\n                midSeller\n              }\n            }"]);return m=function(){return t},t}var v={components:{DialogDisposeQrCode:n.a,TheLogItem:o.a,TheLogEmpty:c.a},data:function(){return{merchantInfo:{amount:8e4},listLoading:!1,listFinished:!0,pageNo:0,pageSize:10,list:[]}},computed:{dataText:function(){return this.list.length>0?this.$t("message.noMore"):this.$t("message.noData")},isUserBtnDisable:function(){return!this.merchantInfo||!this.merchantInfo.sellerUser||0==this.merchantInfo.sellerUser.length},isRecoBtnDisable:function(){return!this.merchantInfo||!this.merchantInfo.midSeller||0==this.merchantInfo.midSeller.length}},methods:{watchAddress:function(){var t=this;this.$toast.loading(),setTimeout((function(){t.creatQrCode()}),100),this.list=[],this.reqMerchantInfo(!0)},getQRUrl:function(){return window.location.origin+"/#/user?merchant=".concat(this.address,"&referrer=").concat(this.address)},creatQrCode:function(){var t=this.getQRUrl(),e=document.querySelector(".qr-box");document.querySelector("#qrcode").innerHTML="";var s=e.clientWidth;new f.a(this.$refs.qrcode,{text:t,width:s,height:s,colorDark:"#000000",colorLight:"#ffffff"}),this.$toast.clear()},handleShowQr:function(){var t=this.getQRUrl();this.$refs.dialogQR.show(t,"merchant")},addressChange:function(t){return t.slice(0,6)+"......"+t.slice(t.length-6)},reqMerchantInfo:function(){var t=arguments,e=this;return Object(i.a)(regeneratorRuntime.mark((function s(){var a,r,i;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=t.length>0&&void 0!==t[0]&&t[0],s.prev=1,s.next=4,e.$apollo.query({query:Object(l.a)(m()),fetchPolicy:"no-cache",variables:{id:u.f+e.$store.state.address}});case 4:r=s.sent,i=r.data.seller,e.merchantInfo=i||{},i&&a&&e.onRefresh(),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1);case 14:case"end":return s.stop()}}),s,null,[[1,11]])})))()},reqWaterList:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.pageNo=Math.ceil(t.list.length/t.pageSize),e.prev=1,e.next=4,t.$apollo.query({query:Object(l.a)(p()),fetchPolicy:"no-cache",variables:{first:t.pageSize,skip:t.pageNo*t.pageSize,token:t.merchantInfo.token,to:t.merchantInfo.address}});case 4:r=e.sent,i=r.data.logs,(s=t.list).push.apply(s,Object(a.a)(i)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1);case 13:t.listLoading=!1,t.list.length<(t.pageNo+1)*t.pageSize&&(t.listFinished=!0);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))()},onRefresh:function(){this.$store.state.address&&(this.listFinished=!1,this.list=[],this.listLoading=!0,this.reqWaterList(),this.reqMerchantInfo())},onLoad:function(){this.$store.state.address&&(this.listLoading=!0,this.reqWaterList())},goToUser:function(){this.$router.push("/user")},handleToUserList:function(){this.$router.push({path:"/list",query:{role:"user",from:this.address}})},handleToReferrerList:function(){this.$router.push({path:"/list",query:{role:"referrer",from:this.address}})},copyCallback:Object(d.a)((function(){this.$toast.success(this.$t("message.addressCopied"))}),350)}},g=(s("b12e"),s("2877")),b=Object(g.a)(v,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"merchant-wrap"},[a("div",{staticClass:"role-wrap"},[a("span",{staticClass:"role"},[t._v(t._s(t.$t("home.merchantSub")))]),a("div",{staticClass:"title switch-wrap",on:{click:t.goToUser}},[a("img",{staticClass:"img",attrs:{src:s("0081"),alt:""}}),a("span",[t._v(t._s(t.$t("home.switchRole")))])])]),a("div",{staticClass:"c-panel total-panel"},[a("div",{staticClass:"top"},[a("div",{staticClass:"asset-wrap"},[a("div",{staticClass:"tit"},[t._v(t._s(t.$t("home.merchantTotal")))]),a("div",{staticClass:"asset-value"},[t._v(t._s(t.toFixedFloor((t.merchantInfo.amount||0)/1e18,2)))]),a("Copy",{attrs:{content:t.$store.state.address},on:{copyCallback:t.copyCallback}},[a("p",{staticClass:"address-line"},[t._v(" "+t._s(t.addressChange(t.address))+" "),a("i",{staticClass:"copy-icon"})])])],1),a("div",{staticClass:"qr-wrap",on:{click:t.handleShowQr}},[a("div",{staticClass:"qr-box"},[a("div",{ref:"qrcode",attrs:{id:"qrcode"}})]),a("div",{staticClass:"desc"},[t._v(t._s(t.$t("home.qrCode")))])])])]),a("div",{staticClass:"btns-wrap"},[a("button",{staticClass:"btn btn-dark",attrs:{disabled:t.isUserBtnDisable},on:{click:function(e){return t.handleToUserList("user")}}},[t._v(" "+t._s(((t.merchantInfo.sellerUser||{}).length||0)+t.$t("home.user"))+" ")]),a("button",{staticClass:"btn btn-dark",attrs:{disabled:t.isRecoBtnDisable},on:{click:function(e){return t.handleToReferrerList("referrer")}}},[t._v(" "+t._s(((t.merchantInfo.midSeller||{}).length||0)+t.$t("home.referrer"))+" ")])]),a("div",{staticClass:"journal-list"},[a("div",{staticClass:"journal-title"},[t._v(t._s(t.$t("home.waterTitle")))]),a("van-list",{attrs:{finished:t.listFinished,"finished-text":t.dataText},on:{load:t.onLoad},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},[t.list.length?t._e():a("TheLogEmpty"),t._l(t.list,(function(t,e){return a("TheLogItem",{key:e,attrs:{item:t,type:"merchant"}})}))],2)],1),a("div",{staticClass:"coop-mail"},[t._v(t._s(t.$t("home.cooperationEmail")))]),a("DialogDisposeQrCode",{ref:"dialogQR"})],1)}),[],!1,null,"7d2382fa",null);e.default=b.exports},"42bf":function(t,e,s){"use strict";s("fb6a");var a=s("d044"),r=s.n(a),i={data:function(){return{visible:!1,role:null}},methods:{addressChange:function(t){return t.slice(0,6)+"......"+t.slice(t.length-6)},creatQrCode:function(t){var e=document.querySelector(".dialog-qr-box").clientWidth;this.$refs.qrcode.innerHTML="",new r.a(this.$refs.qrcode,{text:t,width:e,height:e,colorDark:"#000000",colorLight:"#fff",correctLevel:r.a.CorrectLevel.H}),this.$toast.clear()},hide:function(){this.visible=!1},show:function(t,e){var s=this;this.visible=!0,setTimeout((function(){s.creatQrCode(t)}),0),this.role=e}}},n=(s("6756e"),s("11b2"),s("2877")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-dispose-qr-wrap"},[s("van-dialog",{staticClass:"dialog-box",attrs:{"show-cancel-button":!1,"show-confirm-button":!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[s("div",{staticClass:"dialog-content"},[s("p",{staticClass:"p title"},[t._v(t._s(t.$t("home.scanToDispose")))]),s("div",{staticClass:"dialog-qr-box"},[s("div",{ref:"qrcode",attrs:{id:"qrcode"}})]),t.role?s("p",{staticClass:"p desc"},[t._v(t._s("商家销毁凭证收款码"))]):s("p",{staticClass:"p desc"},[t._v(t._s(t.$t("home.theQr").replace(/\{\{addr\}\}/,t.addressChange(t.$store.state.address))))])]),s("div",{staticClass:"cancel-box"},[s("van-icon",{staticClass:"cancel-btn",attrs:{name:"close"},on:{click:function(e){t.visible=!1}}})],1)])],1)}),[],!1,null,"47fbbe0e",null);e.a=o.exports},"49f3":function(t,e,s){},"52eb":function(t,e,s){},"541d":function(t,e,s){"use strict";s("00d6")},"54da":function(t,e,s){"use strict";s("1f33")},"54f8":function(t,e,s){"use strict";var a={props:{item:{type:Object,default:function(){}},type:{type:String,default:"user"}}},r=(s("f733"),s("2877")),i=Object(r.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"the-log-item"},[s("div",{staticClass:"head"},[s("span",{staticClass:"date"},[t._v(t._s(t.formatTime(1e3*t.item.timestamp)))]),"user"==t.type||"mer-user"==t.type?s("span",{staticClass:"value"},[t._v("-"+t._s(t.toFixedFloor((t.item.amount||0)/1e18))+"(TSR)")]):t._e(),"merchant"==t.type||"referrer"==t.type?s("span",{staticClass:"value"},[t._v("+"+t._s(t.toFixedFloor((t.item.amount||0)/1e18))+"(DST)")]):t._e()]),"merchant"==t.type||"mer-user"==t.type?s("div",{staticClass:"addr"},[t._v("Referrer: "+t._s(t.item.mid))]):t._e(),"merchant"==t.type||"referrer"==t.type?s("div",{staticClass:"addr"},[t._v("From: "+t._s(t.item.from))]):t._e(),"referrer"==t.type?s("div",{staticClass:"addr"},[t._v("To: "+t._s(t.item.to))]):t._e(),"user"==t.type||"mer-user"==t.type?s("div",{staticClass:"addr"},[t._v("To: "+t._s(t.item.to))]):t._e()])}),[],!1,null,"7b4128fc",null);e.a=i.exports},"58e6e":function(t,e,s){"use strict";s.r(e);s("fb6a");var a=s("2909"),r=s("8785"),i=(s("96cf"),s("1da1")),n=s("5184"),o=s("54f8"),c=s("f588"),l={data:function(){return{visible:!1}},methods:{hide:function(){this.visible=!1},show:function(){this.visible=!0}}},d=(s("54da"),s("aa60"),s("2877")),u=Object(d.a)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-protocol"},[s("van-dialog",{staticClass:"dialog-box",attrs:{"show-cancel-button":!1,"show-confirm-button":!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[s("div",{staticClass:"dialog-content"},[s("p",{staticClass:"p title"},[t._v(t._s(t.$t("home.protocolTitle")))]),s("p",{staticClass:"p desc",domProps:{innerHTML:t._s(t.$t("home.protocolDetail"))}}),s("div",{staticClass:"btn-box"},[s("button",{staticClass:"btn btn-dark",on:{click:t.hide}},[t._v(" "+t._s(t.$t("home.known"))+" ")])])]),s("div",{staticClass:"cancel-box"},[s("van-icon",{staticClass:"cancel-btn",attrs:{name:"close"},on:{click:function(e){t.visible=!1}}})],1)])],1)}),[],!1,null,"477003e0",null).exports,h=s("a953"),f=s("35ad");function p(){var t=Object(r.a)(["query ($from: Bytes!, $token: Bytes!, $first: Int!, $skip: Int!) {\n            logs(where: { from: $from, token: $token }, first: $first, skip: $skip, orderBy: timestamp, orderDirection: desc) {\n                id\n                from\n                to\n                mid\n                token\n                amount\n                timestamp\n              }\n            }"]);return p=function(){return t},t}function m(){var t=Object(r.a)(["query ($id: ID!) {\n            user(id: $id) {\n                id\n                address\n                token\n                amount\n              }\n            }"]);return m=function(){return t},t}var v={components:{TheLogItem:o.a,TheLogEmpty:c.a,DialogProtocol:u},data:function(){return{timer:null,isShowDispose:!1,merchant:"",referrer:"",listLoading:!1,listFinished:!0,tsrBalance:0,inputValue:"",disposeToken:"TSR",userInfo:{id:"",address:"",token:"",amount:8e4},pageNo:0,pageSize:10,list:[],isAgreed:!1}},computed:{dataText:function(){return this.list.length>0?this.$t("message.noMore"):this.$t("message.noData")},isDisabled:function(){return+this.inputValue<=0||!this.isAgreed}},watch:{inputValue:function(t){t>this.tsrBalance&&(this.inputValue=this.tsrBalance,this.$toast.fail("TSR余额"+this.tsrBalance))}},beforeDestroy:function(){clearTimeout(this.timer),this.timer=null},methods:{watchAddress:function(){this.list=[],this.reqUserInfo(!0),this.reqUserBalance(),this.$route.query.merchant&&(this.isShowDispose=!0,this.merchant=this.$route.query.merchant),this.$route.query.referrer&&(this.referrer=this.$route.query.referrer),this.checkPending(["dispose"])},reqUserBalance:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$tsrContract.methods.balanceOf(t.address).call();case 3:s=e.sent,t.tsrBalance=s/1e5,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},reqUserInfo:function(){var t=arguments,e=this;return Object(i.a)(regeneratorRuntime.mark((function s(){var a,r,i;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=t.length>0&&void 0!==t[0]&&t[0],s.prev=1,s.next=4,e.$apollo.query({query:Object(n.a)(m()),fetchPolicy:"no-cache",variables:{id:f.f+e.$store.state.address}});case 4:r=s.sent,i=r.data.user,e.userInfo=i||{},i&&a&&e.onRefresh(),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1);case 14:case"end":return s.stop()}}),s,null,[[1,11]])})))()},reqDisposeList:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Math.ceil(t.list.length/t.pageSize),e.prev=2,e.next=5,t.$apollo.query({query:Object(n.a)(p()),fetchPolicy:"no-cache",variables:{first:t.pageSize,skip:s*t.pageSize,token:t.userInfo.token,from:t.userInfo.address}});case 5:i=e.sent,o=i.data.logs,(r=t.list).push.apply(r,Object(a.a)(o)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2);case 14:t.listLoading=!1,t.listFinished=t.list.length<(s+1)*t.pageSize;case 16:case"end":return e.stop()}}),e,null,[[2,11]])})))()},onRefresh:function(){this.$store.state.address&&(this.listFinished=!1,this.list=[],this.onLoad(),this.reqUserInfo(),this.reqUserBalance())},onLoad:function(){this.$store.state.address&&(this.listLoading=!0,this.reqDisposeList())},handleDispose:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$web3.utils.isAddress(t.merchant)){e.next=3;break}return t.$toast.fail(t.$t("home.invalidMerchantAddress")),e.abrupt("return");case 3:t.$toast.loading({duration:0,forbidClick:!0,message:t.$t("message.destroying")}),s=t.merchant+(t.referrer?t.referrer.slice(2):"0000000000000000000000000000000000000000"),a="",t.$tsrContract.methods.approveAndCall(f.d,1e5*t.inputValue,s).send({from:t.$store.state.address}).on("transactionHash",(function(e){a=e,t.startCheckState(a,"dispose")})).on("receipt",(function(e){t.removeByTxHash(a),t.onSendOK(e,"dispose")})).on("error",(function(e){t.removeByTxHash(a),t.onSendFail(e,"dispose")}));case 8:case"end":return e.stop()}}),e)})))()},onSendOK:function(t,e){var s=this;"dispose"===e&&(this.clearStateTimer(),this.addIng=!1,this.$toast.clear(),this.$toast.success(this.$t("message.destroyOK")),this.inputValue="",this.timer=setTimeout((function(){s.onRefresh()}),5e3))},onSendFail:function(t,e){"dispose"===e&&(this.clearStateTimer(),this.addIng=!1,this.$toast.clear(),4001!==t.code?this.$toast.fail(this.$t("message.destroyError")):this.$toast.fail(this.$t("message.denied")))},addressChange:function(t){return t.slice(0,6)+"......"+t.slice(t.length-10)},handleAgreeProtocol:function(){this.isAgreed=!this.isAgreed},goToMerchant:function(){this.$router.push("/merchant")},goToReferrer:function(){this.$router.push("/referrer")},copyCallback:Object(h.a)((function(){this.$toast.success(this.$t("message.addressCopied"))}),350)}},g=(s("afc2"),Object(d.a)(v,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-wrap"},[a("div",{staticClass:"role-wrap"},[a("span",{staticClass:"role"},[t._v(t._s(t.$t("home.userSub")))]),a("div",{staticClass:"title switch-wrap",on:{click:t.goToReferrer}},[a("img",{staticClass:"img",attrs:{src:s("0081"),alt:""}}),a("span",[t._v(t._s(t.$t("home.switchRole")))])])]),a("div",{staticClass:"c-panel total-panel"},[a("div",{staticClass:"top"},[a("div",{staticClass:"asset-wrap"},[a("span",{staticClass:"tit"},[t._v(t._s(t.$t("home.disposeTotal")))]),a("span",{staticClass:"asset-value"},[t._v(t._s(t.toFixedFloor((t.userInfo.amount||0)/1e18,2)))])])]),a("Copy",{attrs:{content:t.$store.state.address},on:{copyCallback:t.copyCallback}},[a("p",{staticClass:"address-line"},[t._v(" "+t._s(t.addressChange(t.address))+" "),a("i",{staticClass:"copy-icon"})])])],1),t.isShowDispose?a("div",{staticClass:"c-panel input-panel"},[a("div",{staticClass:"input-title"},[t._v(t._s(t.$t("home.disposeToken")))]),a("div",{staticClass:"input-wrap"},[a("span",{staticClass:"input"},[t._v(t._s(t.disposeToken))])]),a("div",{staticClass:"input-title dispose-title"},[t._v(t._s(t.$t("home.disposeNumber")))]),a("div",{staticClass:"input-wrap"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"input",attrs:{type:"number",oninput:"if(value.length>10)value=value.slice(0,10)",placeholder:t.tsrBalance},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}})]),a("p",{staticClass:"risk-tip protocol-tip"},[a("span",{staticClass:"handler",class:{on:t.isAgreed},on:{click:t.handleAgreeProtocol}},[t._v(t._s(t.$t("home.protocolPrev")))]),a("a",{staticClass:"link",attrs:{href:"javascript:void(0);"},on:{click:function(e){return e.stopPropagation(),t.$refs.dialogProtocol.show()}}},[t._v(" "+t._s(t.$t("home.protocolName"))+" ")])]),a("button",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:t.handleDispose},expression:"{ func: handleDispose }"}],staticClass:"btn btn-dark btn-dispose",attrs:{disabled:t.isDisabled}},[t._v(t._s(t.$t("message.confirm")))])]):t._e(),a("div",{staticClass:"journal-list"},[a("div",{staticClass:"journal-title"},[a("span",[t._v(t._s(t.$t("home.disposeLog")))])]),a("van-list",{attrs:{finished:t.listFinished,"finished-text":t.dataText},on:{load:t.onLoad},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},[t.list.length?t._e():a("TheLogEmpty"),t._l(t.list,(function(t,e){return a("TheLogItem",{key:e,attrs:{item:t,type:"user"}})}))],2)],1),a("div",{staticClass:"coop-mail"},[t._v(t._s(t.$t("home.cooperationEmail")))]),a("div",{staticClass:"to-merchant",on:{click:t.goToMerchant}},[a("span",[t._v(t._s(t.$t("home.toMerchant")))]),a("van-icon",{attrs:{name:"arrow"}})],1),a("DialogProtocol",{ref:"dialogProtocol"})],1)}),[],!1,null,"1f338298",null));e.default=g.exports},6002:function(t,e,s){"use strict";s("7f4d")},6315:function(t,e,s){},"6756e":function(t,e,s){"use strict";s("6315")},"7f4d":function(t,e,s){},"92fd":function(t,e,s){},a511:function(t,e,s){},aa60:function(t,e,s){"use strict";s("92fd")},aeaa:function(t,e,s){},afc2:function(t,e,s){"use strict";s("a511")},b12e:function(t,e,s){"use strict";s("04a0")},bdf8:function(t,e,s){"use strict";s("aeaa")},c2d4:function(t,e,s){"use strict";s("49f3")},ce42:function(t,e,s){"use strict";s.r(e);s("caad"),s("ac1f"),s("5319");var a={name:"",components:{},props:{title:{type:String,default:""}},computed:{imgUrlLang:function(){return"zh-CN"==this.$i18n.locale?s("17b5"):s("5c07")}},methods:{handleToggleLanguage:function(){var t="en-US"==this.$i18n.locale?"zh-CN":"en-US";this.$store.commit("setLanguage",t)}}},r=(s("6002"),s("2877")),i={components:{TheHeaderSub:Object(r.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header-common"},[s("van-nav-bar",{attrs:{title:t.title,border:!1},on:{"click-left":function(e){return t.$emit("click-left")}}})],1)}),[],!1,null,"6f43b7c0",null).exports},data:function(){return{loading:!1,refreshing:!1}},computed:{role:function(){return["referrer","merchant","user"].includes(this.$route.query.role)?this.$route.query.role:"user"}},methods:{onRefresh:function(){this.refreshing&&(this.refreshing=!1),this.$refs.subView.onRefresh()},goToMerchant:function(){this.$router.push("/merchant")},handleBack:function(){this.$router.isBack=!0,this.$router.replace("/")}}},n=(s("c2d4"),Object(r.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"role-wrapper"},[s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[s("TheHeaderSub",{attrs:{title:t.$t("home.title")}}),s("div",{staticClass:"top-deco"}),s("router-view",{ref:"subView",staticClass:"content",attrs:{refreshing:t.refreshing}})],1)],1)}),[],!1,null,"f380d284",null));e.default=n.exports},ce6c:function(t,e,s){"use strict";s.r(e);s("99af"),s("fb6a");var a=s("2909"),r=s("8785"),i=(s("96cf"),s("1da1")),n=s("42bf"),o=s("54f8"),c=s("f588"),l=s("a953"),d=s("35ad"),u=s("5184"),h=s("d044"),f=s.n(h);function p(){var t=Object(r.a)(["query ($mid: Bytes!,$token: Bytes!, $first: Int!, $skip: Int!) {\n            logs(where: { mid: $mid, token: $token }, first: $first, skip: $skip, orderBy: timestamp, orderDirection: desc) {\n                id\n                from\n                to\n                mid\n                token\n                amount\n                timestamp\n              }\n            }"]);return p=function(){return t},t}function m(){var t=Object(r.a)(["query ($id: ID!) {\n            mid(id: $id) {\n                id\n                address\n                token\n                amount\n                midUser\n                midSeller\n              }\n            }"]);return m=function(){return t},t}var v={components:{DialogDisposeQrCode:n.a,TheLogItem:o.a,TheLogEmpty:c.a},data:function(){return{inputAddress:"",referrerInfo:{amount:8e4},listLoading:!1,listFinished:!0,pageNo:0,pageSize:10,list:[],hasQr:!1}},computed:{dataText:function(){return this.list.length>0?this.$t("message.noMore"):this.$t("message.noData")}},methods:{watchAddress:function(){this.list=[],this.reqReferrerInfo(!0)},getQRUrl:function(){return window.location.origin+"/#/user?merchant=".concat(this.inputAddress,"&referrer=").concat(this.address)},creatQrCode:function(){var t=this.getQRUrl(),e=document.querySelector(".qr-box");document.querySelector("#qrcode").innerHTML="";var s=e.clientWidth;new f.a(this.$refs.qrcode,{text:t,width:s,height:s,colorDark:"#000000",colorLight:"#ffffff"})},handleReGene:function(){this.hasQr=!1,this.inputAddress=""},handleGenerate:function(){var t=this;if(!this.$web3.utils.isAddress(this.inputAddress))return this.$toast.fail(this.$t("message.invalidAddress"));this.hasQr=!0,setTimeout((function(){t.creatQrCode()}),6)},reqReferrerInfo:function(){var t=arguments,e=this;return Object(i.a)(regeneratorRuntime.mark((function s(){var a,r,i;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=t.length>0&&void 0!==t[0]&&t[0],s.prev=1,s.next=4,e.$apollo.query({query:Object(u.a)(m()),fetchPolicy:"no-cache",variables:{id:d.f+e.$store.state.address}});case 4:r=s.sent,i=r.data.mid,e.referrerInfo=i||{},i&&a&&e.onRefresh(),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1);case 14:case"end":return s.stop()}}),s,null,[[1,11]])})))()},reqRecommendList:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s,r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Math.ceil(t.list.length/t.pageSize),e.prev=1,e.next=4,t.$apollo.query({query:Object(u.a)(p()),fetchPolicy:"no-cache",variables:{first:t.pageSize,skip:s*t.pageSize,token:t.referrerInfo.token,mid:t.referrerInfo.address}});case 4:i=e.sent,n=i.data.logs,(r=t.list).push.apply(r,Object(a.a)(n)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1);case 13:t.listLoading=!1,t.list.length<(s+1)*t.pageSize&&(t.listFinished=!0);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))()},onRefresh:function(){this.$store.state.address&&(this.listFinished=!1,this.list=[],this.onLoad(),this.reqReferrerInfo(!1))},onLoad:function(){this.$store.state.address&&(this.listLoading=!0,this.reqRecommendList())},addressChange:function(t){return t.slice(0,6)+"......"+t.slice(t.length-6)},handleToList:function(){this.$router.push({path:"/list",query:{role:"merchant",from:this.address}})},goToMerchant:function(){this.$router.push("/merchant")},goToUser:function(){this.$router.push("/user")},copyCallback:Object(l.a)((function(){this.$toast.success(this.$t("message.addressCopied"))}),350)}},g=(s("bdf8"),s("2877")),b=Object(g.a)(v,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"referrer-wrap"},[a("div",{staticClass:"role-wrap"},[a("span",{staticClass:"role"},[t._v(t._s(t.$t("home.referrerSub")))]),a("div",{staticClass:"title switch-wrap",on:{click:t.goToUser}},[a("img",{staticClass:"img",attrs:{src:s("0081"),alt:""}}),a("span",[t._v(t._s(t.$t("home.switchRole")))])])]),a("div",{staticClass:"c-panel total-panel"},[a("div",{staticClass:"top"},[a("div",{staticClass:"asset-wrap"},[a("span",{staticClass:"tit"},[t._v(t._s(t.$t("home.recommendTotal")))]),a("span",{staticClass:"asset-value"},[t._v(t._s(t.toFixedFloor((t.referrerInfo.amount||0)/1e18,2)))])])]),a("Copy",{attrs:{content:t.$store.state.address},on:{copyCallback:t.copyCallback}},[a("p",{staticClass:"address-line"},[t._v(" "+t._s(t.addressChange(t.address))+" "),a("i",{staticClass:"copy-icon"})])])],1),a("div",{staticClass:"c-panel input-panel"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.hasQr,expression:"!hasQr"}]},[a("div",{staticClass:"input-title"},[t._v(t._s(t.$t("home.inputMerchantAddress")))]),a("div",{staticClass:"input-wrap"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputAddress,expression:"inputAddress"}],staticClass:"input",attrs:{type:"text",placeholder:"0x address"},domProps:{value:t.inputAddress},on:{input:function(e){e.target.composing||(t.inputAddress=e.target.value)}}})]),a("div",{staticClass:"btn btn-dark",on:{click:t.handleGenerate}},[t._v(t._s(t.$t("home.generateQr")))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.hasQr,expression:"hasQr"}],staticClass:"qr-wrap"},[a("div",{staticClass:"qr-title",on:{click:t.handleReGene}},[a("van-icon",{staticClass:"arrow-back",attrs:{name:"arrow-left"}}),a("p",[t._v(t._s(t.$t("home.scanToDispose")))])],1),a("div",{staticClass:"qr-box"},[a("div",{ref:"qrcode",attrs:{id:"qrcode"}})]),a("div",{staticClass:"tip"},[a("p",{staticClass:"p desc"},[t._v(t._s(t.$t("home.theQr").replace(/\{\{addr\}\}/,t.addressChange(t.$store.state.address))))])])])]),a("div",{staticClass:"journal-list"},[a("div",{staticClass:"journal-title"},[a("span",[t._v(t._s(t.$t("home.recommendLog")))]),a("span",{staticClass:"tip btn btn-lignt",on:{click:function(e){return t.handleToList("cooperators")}}},[t._v(" "+t._s(((t.referrerInfo.midSeller||{}).length||0)+t.$t("home.recommendLogTip"))+" ")])]),a("van-list",{attrs:{finished:t.listFinished,"finished-text":t.dataText},on:{load:t.onLoad},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},[t.list.length?t._e():a("TheLogEmpty"),t._l(t.list,(function(t,e){return a("TheLogItem",{key:e,attrs:{item:t,type:"referrer"}})}))],2)],1),a("div",{staticClass:"coop-mail"},[t._v(t._s(t.$t("home.cooperationEmail")))]),a("div",{staticClass:"to-merchant",on:{click:t.goToMerchant}},[a("span",[t._v(t._s(t.$t("home.toMerchant")))]),a("van-icon",{attrs:{name:"arrow"}})],1),a("DialogDisposeQrCode",{ref:"dialogQR"})],1)}),[],!1,null,"db7ff07e",null);e.default=b.exports},f588:function(t,e,s){"use strict";var a=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"empty-wrap"},[e("img",{staticClass:"img-empty",attrs:{src:s("2724"),alt:""}})])}],r={props:{item:{type:Object,default:function(){}},type:{type:String,default:"user"}}},i=(s("541d"),s("2877")),n=Object(i.a)(r,(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),a,!1,null,"9f51d59c",null);e.a=n.exports},f733:function(t,e,s){"use strict";s("0522")}}]);